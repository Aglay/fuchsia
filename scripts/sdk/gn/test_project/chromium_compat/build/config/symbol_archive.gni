# Copyright 2019 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//third_party/fuchsia-sdk/build/symbol_archive.gni")
assert(is_fuchsia)

# Creates a tarball of unstripped binaries, structured according to the
# ".build_ids" convention used by the symbolizer and GNU GDB.
#
# Parameters:
#   deps: Must all be cr_fuchsia_package() or fuchsia_package() targets.
#   ids_txt: The "ids.txt" file which lists the relative paths to unstripped
#            executables and libraries, along with their build IDs.
#   archive_name: The path to the compressed tarball that will be generated.
template("symbol_archive") {
  #assert(!is_debug)

  fuchsia_symbol_archive(target_name) {
    # Specifying the package as a public_dep
    # allows the id.txt file generated when the
    # package is being built to be used as an input here.
    public_deps = invoker.deps
    ids_txt = invoker.ids_txt

    archive_name = invoker.archive_name
  }
}
