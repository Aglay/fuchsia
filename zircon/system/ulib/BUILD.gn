# Copyright 2020 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# This target holds tests under //zircon/system/ulib which are now hosted in
# packages but whose code hasn't yet been migrated to //src.
# When a migration happens, the test needs to be removed from this list and
# placed within the proper `tests` target under //src.

import("//build/fuzzing/fuzzer.gni")

# IMPORTANT NOTE
# Do not add more libraries to this directory.
# New libraries should be introduced under //src.

group("tests") {
  testonly = true
  deps = [
    ":fuzzers",
    "edid:tests",
    "fbl/test:fbl($host_toolchain)",
    "ffl/test:ffl($host_toolchain)",
    "fit/test($host_toolchain)",
    "fs/journal/test",
    "fs/transaction/test($host_toolchain)",
    "ftl/test:tests",
    "fvm-host:fvm-host-test($host_toolchain)",
    "fvm/test:fvm-unit($host_toolchain)",
    "fvm/test:tests",
    "fzl:tests",
    "hid-parser/test:tests",
    "inspect:tests",
    "memfs/test:tests",
    "storage/buffer/test",
    "storage/operation/test",
    "sysconfig-client:tests",
    "trace-reader/test:trace-reader-test($host_toolchain)",
    "uart/test($host_toolchain)",
    "zbi/test:zbi($host_toolchain)",
    "zbitl/test",
    "zxio:tests",
    "zxtest/test:zxtest($host_toolchain)",
    "zxtest/test/integration:zxtest-integration($host_toolchain)",
  ]

  if (current_os == "linux") {
    deps += [
      "ftl-mtd/test:ftl-volume-wrapper($host_toolchain)",
      "ftl-mtd/test:nand-volume-driver($host_toolchain)",
      "nand-redundant-storage/test:nand-redundant-storage($host_toolchain)",
    ]
  }
}

fuzzers_package("fuzzers") {
  package_name = "zircon-fuzzers"
  cpp_fuzzers = [
    "affine/test:affine-fuzzer",
    "bitmap/test:raw-bitmap-fuzzer",
    "elfload/test:elfload-fuzzer",
    "fs/journal/test:journal-entry-fuzzer",
    "fs/journal/test:journal-fuzzer",
    "fs/journal/test:journal-replay-fuzzer",
    "fs/test:vmo_file-fuzzer",
    "gfx/test:gfx-fuzzer",
    "hid-parser/test:hid-parser-fuzzer",
    "ldmsg/test:ldmsg-fuzzer",
    "tftp/test:tftp-fuzzer",
    "utf_conversion/test:utf_conversion-fuzzer",
    "zbi-bootfs/test:zbi-bootfs-fuzzer",
    "zircon-crypto/test:hmac-fuzzer",
    "//zircon/third_party/ulib/lz4/test:lz4-decompress-fuzzer",
    "//zircon/third_party/ulib/lz4/test:lz4-roundtrip-fuzzer",
  ]
}
