# Copyright 2018 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/test/test_package.gni")
import("//build/testing/environments.gni")

test_package("netemul_sandbox_test") {
  deps = [
    "//garnet/bin/netemul_runner:sandbox_unittest",
    "//garnet/bin/netemul_runner/helpers/mock_device_settings",
    "//garnet/bin/netemul_runner/model:model_unittest",
    "//garnet/bin/netemul_runner/test/dummy_proc",
    "//garnet/bin/netemul_runner/test/dynamic_devices",
    "//garnet/bin/netemul_runner/test/easy_netstack_cfg",
    "//garnet/bin/netemul_runner/test/env_build",
    "//garnet/bin/netemul_runner/test/inheritance",
    "//garnet/bin/netemul_runner/test/netstack_socks",
    "//garnet/bin/netemul_runner/test/sandbox_service",
    "//garnet/bin/netemul_runner/test/svc_list",
  ]

  meta = [
    {
      path = rebase_path("meta/svc_list_run.cmx")
      dest = "svc_list_run.cmx"
    },
    {
      path = rebase_path("meta/netstack_socks_run.cmx")
      dest = "netstack_socks_run.cmx"
    },
    {
      path = rebase_path("meta/env_build_run.cmx")
      dest = "env_build_run.cmx"
    },
    {
      path = rebase_path("meta/dummy_proc.cmx")
      dest = "dummy_proc.cmx"
    },
    {
      path = rebase_path("meta/easy_netstack_cfg_run.cmx")
      dest = "easy_netstack_cfg_run.cmx"
    },
    {
      path = rebase_path("meta/inheritance_run.cmx")
      dest = "inheritance_run.cmx"
    },
    {
      path = rebase_path("meta/dynamic_devices_run.cmx")
      dest = "dynamic_devices_run.cmx"
    },
  ]

  binaries = [
    {
      name = "dummy_proc"
    },
  ]

  tests = [
    {
      name = "svc_list"
      environments = basic_envs
    },
    {
      name = "netstack_socks"
      environments = basic_envs
    },
    {
      name = "env_build"
      environments = basic_envs
    },
    {
      name = "model_unittest"
      environments = basic_envs
    },
    {
      name = "sandbox_unittest"
      environments = basic_envs
    },
    {
      name = "easy_netstack_cfg"
      environments = basic_envs
    },
    {
      name = "inheritance"
      environments = basic_envs
    },
    {
      name = "sandbox_service_bin_test"
      dest = "sandbox_service"
      environments = basic_envs
    },
    {
      name = "dynamic_devices"
      environments = basic_envs
    },
    {
      name = "mock_device_settings_bin_test"
      dest = "mock_device_settings"
    },
  ]
}
