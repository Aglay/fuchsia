# Copyright 2017 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("../boringssl.gni")

# See //third_party/boringssl/crypto/CMakeLists.txt
source_set("crypto") {
  visibility = [ "//third_party/boringssl/*" ]
  configs += [ "//third_party/boringssl:internal_config" ]
  deps = [
    ":base",
    "asn1",
    "base64",
    "bio",
    "bn_extra",
    "buf",
    "bytestring",
    "chacha",
    "cipher_extra",
    "cmac",
    "conf",
    "curve25519",
    "dh",
    "digest_extra",
    "dsa",
    "ec_extra",
    "ecdh",
    "ecdsa_extra",
    "engine",
    "err",
    "evp",
    "fipsmodule",
    "hkdf",
    "lhash",
    "obj",
    "pem",
    "pkcs7",
    "pkcs8",
    "poly1305",
    "pool",
    "rand_extra",
    "rc4",
    "rsa_extra",
    "stack",
    "x509",
    "x509v3",
  ]
}

source_set("base") {
  visibility = [ ":*" ]
  sources = [
    "cpu-aarch64-linux.c",
    "cpu-arm-linux.c",
    "cpu-arm.c",
    "cpu-intel.c",
    "cpu-ppc64le.c",
    "crypto.c",
    "ex_data.c",
    "mem.c",
    "refcount_c11.c",
    "refcount_lock.c",
    "thread.c",
    "thread_none.c",
    "thread_pthread.c",
    "thread_win.c",
  ]
  configs += [ "//third_party/boringssl:internal_config" ]
}

executable("crypto_test") {
  testonly = true
  sources = [
    "$target_gen_dir/crypto_test_data.cc",
    "asn1/asn1_test.cc",
    "base64/base64_test.cc",
    "bio/bio_test.cc",
    "bytestring/bytestring_test.cc",
    "chacha/chacha_test.cc",
    "cipher_extra/aead_test.cc",
    "cipher_extra/cipher_test.cc",
    "cmac/cmac_test.cc",
    "compiler_test.cc",
    "constant_time_test.cc",
    "curve25519/ed25519_test.cc",
    "curve25519/spake25519_test.cc",
    "curve25519/x25519_test.cc",
    "dh/dh_test.cc",
    "digest_extra/digest_test.cc",
    "dsa/dsa_test.cc",
    "ecdh/ecdh_test.cc",
    "err/err_test.cc",
    "evp/evp_extra_test.cc",
    "evp/evp_test.cc",
    "evp/pbkdf_test.cc",
    "evp/scrypt_test.cc",
    "fipsmodule/aes/aes_test.cc",
    "fipsmodule/bn/bn_test.cc",
    "fipsmodule/ec/ec_test.cc",
    "fipsmodule/ec/p256-x86_64_test.cc",
    "fipsmodule/ecdsa/ecdsa_test.cc",
    "fipsmodule/modes/gcm_test.cc",
    "fipsmodule/rand/ctrdrbg_test.cc",
    "hkdf/hkdf_test.cc",
    "hmac_extra/hmac_test.cc",
    "lhash/lhash_test.cc",
    "obj/obj_test.cc",
    "pkcs7/pkcs7_test.cc",
    "pkcs8/pkcs12_test.cc",
    "pkcs8/pkcs8_test.cc",
    "poly1305/poly1305_test.cc",
    "pool/pool_test.cc",
    "refcount_test.cc",
    "rsa_extra/rsa_test.cc",
    "test/file_test_gtest.cc",
    "thread_test.cc",
    "x509/x509_test.cc",
    "x509v3/tab_test.cc",
    "x509v3/v3name_test.cc",
  ]
  configs += [ "//third_party/boringssl:test_config" ]
  deps = [
    ":crypto",
    "test:gtest_main",
    "test:test_support",
    "//third_party/boringssl:util/embed_test_data.go",
  ]
}
