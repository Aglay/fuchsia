# Copyright 2017 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("../../boringssl.gni")

# See //third_party/boringssl/crypto/cipher_extra/CMakeLists.txt
source_set("cipher_extra") {
  visibility = [ "//third_party/boringssl/*" ]
  sources = [
    "cipher_extra.c",
    "derive_key.c",
    "e_aesctrhmac.c",
    "e_aesgcmsiv.c",
    "e_chacha20poly1305.c",
    "e_null.c",
    "e_rc2.c",
    "e_rc4.c",
    "e_ssl3.c",
    "e_tls.c",
    "tls_cbc.c",
  ]
  configs += [ "//third_party/boringssl:internal_config" ]
  if (current_cpu == "arm64") {
    deps = []
  } else if (current_cpu == "x64") {
    deps = [
      ":crypto_cipher_extra_asm",
    ]
  }
}

perlasm("crypto_cipher_extra_asm") {
  # Note: this action should only be a dependency when current_cpu == "x64".
  sources = [
    "asm/aes128gcmsiv-x86_64.pl",
    "asm/chacha20_poly1305_x86_64.pl",
  ]
}
